{
  "version": "v1",
  "vectors": [
    {
      "name": "missing-replyto",
      "ns": "myapp",
      "kid": "kid-missing-rt",
      "x402": {
        "invoiceId": "inv_missing_rt",
        "chainId": 8453,
        "tokenContract": "0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "amount": "100",
        "recipient": "0xbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb",
        "txHash": "0xcccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc",
        "expiry": 1754650500,
        "priceHash": "0xdddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd"
      },
      "plaintext_b64u": "bmVnLW1pc3NpbmctcnQ",
      "expected_error": "REPLY_TO_REQUIRED"
    },
    {
      "name": "replytojwks-non-https",
      "ns": "myapp",
      "kid": "kid-rtjwks-http",
      "x402": {
        "invoiceId": "inv_rtjwks_http",
        "chainId": 8453,
        "tokenContract": "0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "amount": "200",
        "recipient": "0xbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb",
        "txHash": "0xcccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc",
        "expiry": 1754650600,
        "priceHash": "0xdddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd",
        "replyToJwks": "http://example.com/jwks.json",
        "replyToKid": "kid-client"
      },
      "plaintext_b64u": "bmVnLXJ0ancrLWh0dHA",
      "expected_error": "REPLY_TO_JWKS_HTTPS_REQUIRED"
    },
    {
      "name": "replytojwk-bad-crv",
      "ns": "myapp",
      "kid": "kid-rtjwk-bad",
      "x402": {
        "invoiceId": "inv_rtjwk_bad",
        "chainId": 8453,
        "tokenContract": "0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "amount": "300",
        "recipient": "0xbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb",
        "txHash": "0xcccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc",
        "expiry": 1754650700,
        "priceHash": "0xdddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd",
        "replyToJwk": { "kty": "OKP", "crv": "Ed25519", "x": "AQEBAQEBAQEBAQEBAQEBAQ" }
      },
      "plaintext_b64u": "bmVnLXJ0anBrLWJhZA",
      "expected_error": "REPLY_TO_REQUIRED"
    },
    {
      "name": "sidecar-allowlist-replypublicok",
      "ns": "myapp",
      "kid": "kid-rt-sidecar",
      "x402": {
        "invoiceId": "inv_rt_sidecar",
        "chainId": 8453,
        "tokenContract": "0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "amount": "400",
        "recipient": "0xbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb",
        "txHash": "0xcccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc",
        "expiry": 1754650800,
        "priceHash": "0xdddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd",
        "replyToJwk": { "kty": "OKP", "crv": "X25519", "x": "AQEBAQEBAQEBAQEBAQEBAQ" }
      },
      "app": { "replyPublicOk": true, "traceId": "abc" },
      "allowlist": ["replyPublicOk"],
      "plaintext_b64u": "bmVnLXJ0LWFsbG93bGlzdA",
      "expected_error": "REPLY_TO_SIDECAR_FORBIDDEN"
    }
  ]
}
